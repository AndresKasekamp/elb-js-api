import{bA as j,nF as He,dE as Qe,py as J,xS as Je,xX as Ke,bi as K,xR as we,xY as Ie,xQ as et,y3 as tt,de as rt,y5 as st,y6 as nt,yp as it,y7 as at,yq as ot,va as z,m5 as ct,yd as dt,yr as lt,ys as ut,yt as gt,yu as ht,yv as pt,xT as ft,m3 as bt,yh as mt,b2 as T,b8 as Ae,jR as _t,ql as ne,b0 as Tt,bI as l,b3 as R,c7 as ke,c2 as P,bz as ee,bO as b,ca as p,wh as fe,og as F,bQ as We,oj as G,yw as je,c9 as V,c6 as C,bL as y,b4 as w,oe as $t,wD as Ot,yx as le,yy as wt,yz as It,kq as At,wn as Ge,cG as Ct,i1 as Et,ma as Fe,ch as vt,o8 as Mt,yA as Rt,o7 as Be,yB as ue,nw as Ce,oc as Pt,pV as yt,R as St,b9 as W,B as be,P as me,W as E,bb as N,rz as _,b1 as M,hR as Lt,kL as qe,bR as Nt,bS as Ee,bM as X,hY as Y,a8 as te,rB as ve,wm as Me,bT as ce,ha as Re,nx as Pe,yC as ye,wk as Se,wz as xt}from"./index-pCX-0tJH.js";import{M as Ut,$ as _e,D as Vt,e as m,O as ze}from"./ShadedColorMaterial.glsl-L0JVQzbX.js";import{g as Dt}from"./ImageMaterial.glsl-PU0wbmEN.js";import{u as Ht,r as kt}from"./LineVisualElement-iKo1s90I.js";import{a as Wt}from"./Object3DVisualElement-8HoU366x.js";const jt=j(0,0,0,.04);function Gt({accentColor:e}){return He(e,.5)}function Ft({accentColor:e}){return He(e,.7)}const Cr=Qe("mac")?"Meta":"Control",Er="Shift",Bt=2,qt=1.15,zt=1.15,vr=2500,Mr=.02,Xt=Math.cos(J(45)),Le=Math.cos(J(5)),Rr=.95,Pr=.3,yr=2,Yt=1,Zt=3,Xe=11,ge=22.5,Q=40,Ne=48,Qt=2.25,Jt=4,xe=1,Kt=.3,er=6,tr=4,Ue=1600,rr=.4;function Ye(e){const t=new Je,{vertex:a,fragment:s,attributes:n,varyings:i}=t;return Ke(a,e),n.add(K.POSITION,"vec3"),n.add(K.UV0,"vec2"),i.add("vUV","vec2"),a.code.add(we`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add(new Ie("backgroundColor",r=>r.backgroundColor),new Ie("gridColor",r=>r.gridColor),new et("gridWidth",r=>r.gridWidth)),s.code.add(we`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),t}const sr=Object.freeze(Object.defineProperty({__proto__:null,build:Ye},Symbol.toStringTag,{value:"Module"}));class nr extends lt{constructor(){super(...arguments),this.backgroundColor=j(1,0,0,.5),this.gridColor=j(0,1,0,.5),this.gridWidth=4}}class ie extends st{initializeProgram(t){return new nt(t.rctx,ie.shader.get().build(this.configuration),it)}initializePipeline(){return at({blending:ot(z.ONE,z.ONE,z.ONE_MINUS_SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA),depthTest:{func:ct.LESS},colorWrite:dt})}}ie.shader=new tt(sr,()=>rt(()=>Promise.resolve().then(()=>Tr),void 0));let ir=class extends ut{constructor(t){super(t,new or),this._configuration=new gt}createBufferWriter(){return new ht(pt)}produces(t,a){return a===ft.Color&&t===bt.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(t){return new ar(t)}getConfiguration(){return this._configuration}};class ar extends mt{constructor(t){super(t),this.ensureTechnique(ie,null)}beginSlot(){return this.technique}}class or extends nr{constructor(){super(...arguments),this.renderOccluded=T.Occlude,this.isDecoration=!1}}class cr extends Wt{constructor(t){super(t),this._material=null,this._renderOccluded=T.OccludeAndTransparent,this._gridWidth=1,this._gridColor=j(1,0,0,1),this._backgroundColor=j(1,0,0,1),this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){Ae(this._gridColor,t),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){Ae(this._backgroundColor,t),this._updateMaterial()}createExternalResources(){this._material=new ir(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){this._material!=null&&t(this._material)}createGeometries(t){if(this._material!=null){const a=_t(this._material);t.addGeometry(a)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this._material!=null&&this._material.setParameters(this._materialParameters)}}function Lr(e,t,a,s,n,i,r,o){return dr(t,r.worldUpAtPosition(e,l.get()),n,i,o.basis1,o.basis2),p(o.basis1,o.basis1,a),p(o.basis2,o.basis2,s),R(o.origin,e),je(o.basis2,o.basis1,o.origin,o.plane),o}function dr(e,t,a,s,n,i){const r=V(e,t),o=l.get(),u=l.get();switch(s===v.HORIZONTAL_OR_VERTICAL?Math.abs(r)>Xt?v.HORIZONTAL:v.VERTICAL:s){case v.VERTICAL:{const c=Math.abs(r)<=Le?e:a.viewUp;C(o,c,t),R(u,t);break}case v.HORIZONTAL:C(o,a.viewUp,t),C(u,t,o);break;case v.TILTED:{const c=Math.abs(r)<=Le?t:a.viewUp;C(o,c,e),C(u,e,o);break}}const d=C(l.get(),o,u);V(d,a.viewForward)>0&&p(u,u,-1),y(n,o),y(i,u)}function lr(e,t,a){const s=t.worldUpAtPosition(e.origin,l.get()),n=e.basis1,i=Oe(e,s),r=Math.round(i/D)*D;return ue(e,r-i,n,a)}function Nr(e,t,a,s,n,i){const r=R(l.get(),n.origin);b(r,r,p(l.get(),n.basis1,e.direction[0]<0?1:-1)),b(r,r,p(l.get(),n.basis2,e.direction[1]<0?1:-1));const o=P(n.basis1),u=P(n.basis2),d=w(l.get(),a,r),c=w(l.get(),t,r);let g=0,h=0;if($e(e)){const ae=he(n),H=he(i);g=o-.5*e.direction[0]*V(n.basis1,c)/o,h=u-.5*e.direction[1]*V(n.basis2,c)/u;const B=H/ae;g*=B,h*=B}const f=g+.5*e.direction[0]*V(n.basis1,d)/o,O=h+.5*e.direction[1]*V(n.basis2,d)/u,x=p(l.get(),n.basis1,f/o),S=p(l.get(),n.basis2,O/u);(f<=0||Ve(i.origin,x,s)<=Ue)&&R(x,i.basis1),(O<=0||Ve(i.origin,S,s)<=Ue)&&R(S,i.basis2);const $=R(l.get(),r);return b($,$,p(l.get(),x,e.direction[0]<0?-1:1)),b($,$,p(l.get(),S,e.direction[1]<0?-1:1)),$t($,x,S,i)}function xr(e,t){return rr*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function Ur(e,t,a,s){const n=C(l.get(),t,a);return C(n,n,t),ke(e,n,s)}function Vr(e,t){return Ut(e.basis1,e.basis2,e.origin,t)}function Dr(e,t,a,s){const n=t.worldUpAtPosition(e.origin,l.get()),i=l.get();switch(a){case re.HEADING:R(i,n);break;case re.TILT:R(i,e.basis1)}return ke(e.origin,i,s)}function Hr(e,t,a,s){const n=Te(a,I.NEGATIVE_X),i=F.get();Ot(i,t,n.edge*Math.PI/2);const r=y(l.get(),n.basis);let o=p(l.get(),r,n.direction*s.computeScreenPixelSizeAt(n.position)*Q);b(o,o,n.position);const u=s.projectToRenderScreen(o,le(l.get())),d=ur(s,u);wt(s,u,Z),y(Z.direction,Z.direction);const c=l.get();!d&&It(a,Z,c)&&(o=c),i[12]=0,i[13]=0,i[14]=0,e.modelTransform=i,e.renderLocation=At(o),d?e.state|=se:e.state&=~se}function ur(e,t){const[a,s,n,i]=e.viewport,r=Math.min(n,i)/16;let o=!0;return t[0]<a+r?(t[0]=a+r,o=!1):t[0]>a+n-r&&(t[0]=a+n-r,o=!1),t[1]<s+r?(t[1]=s+r,o=!1):t[1]>s+i-r&&(t[1]=s+i-r,o=!1),o}function kr(e,t,a,s){const n=P(s.basis1),i=P(s.basis2),r=Ze(s),o=he(s),u=ee(l.get(),0,0,0);b(u,p(l.get(),s.basis1,t.direction[0]),p(l.get(),s.basis2,t.direction[1])),b(u,s.origin,u);let d=0,c=1;if($e(t))t.direction[0]===1&&t.direction[1]===-1?d=D:t.direction[0]===1&&t.direction[1]===1?d=Math.PI:t.direction[0]===-1&&t.direction[1]===1&&(d=3*Math.PI/2),c=o;else{const h=t.direction[0]!==0?1:2;d=h===1?D:0,c=(h===1?i:n)-r}const g=fe(F.get(),d);We(g,g,ee(l.get(),c,c,c)),G(g,a,g),g[12]=0,g[13]=0,g[14]=0,e.modelTransform=g,e.renderLocation=u}function Wr(e,t,a,s){const n=s.worldUpAtPosition(a.origin,l.get()),i=Te(a,I.POSITIVE_X),r=fe(F.get(),i.edge*Math.PI/2);Ge(r,r,-Oe(a,n)),G(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=i.position}function jr(e,t,a){const s=Te(a,I.POSITIVE_Y),n=fe(F.get(),s.edge*Math.PI/2);Ge(n,n,D),G(n,t,n),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=s.position}var I;function Te(e,t){switch(t){case I.POSITIVE_X:return{basis:e.basis1,direction:1,position:b(l.get(),e.origin,e.basis1),edge:t};case I.POSITIVE_Y:return{basis:e.basis2,direction:1,position:b(l.get(),e.origin,e.basis2),edge:t};case I.NEGATIVE_X:return{basis:e.basis1,direction:-1,position:w(l.get(),e.origin,e.basis1),edge:t};case I.NEGATIVE_Y:return{basis:e.basis2,direction:-1,position:w(l.get(),e.origin,e.basis2),edge:t}}}function Ve(e,t,a){const s=a.projectToRenderScreen(b(l.get(),e,t),le(l.get())),n=a.projectToRenderScreen(w(l.get(),e,t),le(l.get()));return Ct(w(s,s,n))}function Ze(e){const t=P(e.basis1),a=P(e.basis2);return Kt*Math.min(t,a)}function he(e){return Ze(e)}function $e(e){return e.direction[0]!==0&&e.direction[1]!==0}function Gr(e){const t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ht({view:e,attached:!1,color:Ft(e.effectiveTheme),width:Yt,renderOccluded:T.OccludeAndTransparent,geometry:[t],isDecoration:!0})}function Fr(e){return new cr({view:e,attached:!1,backgroundColor:jt,gridColor:Gt(e.effectiveTheme),gridWidth:4,renderOccluded:T.OccludeAndTransparent,isDecoration:!0})}function Br(e,t,a,s=new Mt){if(e==null)return null;const{renderCoordsHelper:n}=t,i=n.fromRenderCoords(e.origin,t.spatialReference);if(i==null)return null;const r=Et(i,a);if(r==null)return null;s.position=r;const o=2*P(e.basis1),u=2*P(e.basis2),d=Fe.renderUnitScaleFactor(t.spatialReference,a);s.width=o*d,s.height=u*d;const c=n.worldUpAtPosition(e.origin,l.get());return s.tilt=vt(Oe(e,c)),s.heading=n.headingAtPosition(e.origin,e.basis1)-90,s}function Oe(e,t){return Rt(t,e.basis2,e.basis1)+D}function gr(e,t,a,s,n,i,r=Be()){return i.toRenderCoords(e,r.origin)?(i.worldBasisAtPosition(r.origin,Ce.X,r.basis1),i.worldBasisAtPosition(r.origin,Ce.Y,r.basis2),je(r.basis2,r.basis1,r.origin,r.plane),ue(r,-J(t),Pt(r),r),ue(r,J(a),r.basis1,r),p(r.basis1,r.basis1,s/2),p(r.basis2,r.basis2,n/2),yt(r),r):(St.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function qr(e,t){if((e==null?void 0:e.position)==null)return null;const a=kt(e.position,t.spatialReference,t.elevationProvider);if(a==null)return null;const s=Fe.renderUnitScaleFactor(e.position.spatialReference,t.spatialReference),n=e.width*s,i=e.height*s;return{position:a,heading:e.heading,tilt:e.tilt,renderWidth:n,renderHeight:i}}function zr(e,t,a,s=Be()){if(e==null)return null;const n=gr(e.position,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,s);return a.tiltEnabled||n==null||lr(n,t.renderCoordsHelper,n),n}(function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"})(I||(I={}));const A=ne.Custom1;var re,v;(function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"})(re||(re={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(v||(v={}));const se=ne.Custom2,Z=Tt(),D=Math.PI/2,de=ne.Custom1,hr=ne.Custom2;function Xr(e){return(e.type==="building-scene-3d"?e:null)!=null}class Yr extends _e{constructor(t,a){const s=$e(a),n=s?Jt:xe,i=n*Bt,r=xe,o={renderOccluded:T.OccludeAndTransparent,isDecoration:!0},u=new W({...o,width:n}),d=new W({...o,width:i}),c=new W({...o,width:r});super({view:t,...Vt,...pr({isCorner:s,unfocusedMaterial:u,focusedMaterial:d,outlineMaterial:c})}),this._themeHandle=be(()=>t.effectiveTheme.accentColor,g=>{const h=E.toUnitRGBA(g);u.setParameters({color:h}),d.setParameters({color:h}),c.setParameters({color:h})},me)}destroy(){this._themeHandle.remove(),super.destroy()}}function pr({isCorner:e,unfocusedMaterial:t,focusedMaterial:a,outlineMaterial:s}){const n=e?[M(1,0,0),M(0,0,0),M(0,1,0)]:[M(1,0,0),M(-1,0,0)];return{renderObjects:[new m(N(t,n),_.Unfocused|de),new m(N(a,n),_.Focused|de),new m(N(s,n),hr)],collisionType:{type:"line",paths:[n]},radius:e?er:tr,state:de}}class Zr extends _e{constructor(t,a){const s=new Dt({transparent:!0,writeDepth:!1,renderOccluded:T.Opaque,isDecoration:!0}),n=ze.calloutWidth,i=new W({width:n,renderOccluded:T.OccludeAndTransparent,isDecoration:!0});super({view:t,...fr({imageMaterial:s,calloutMaterial:i})}),this._currentTexture=null,this._themeHandle=be(()=>t.effectiveTheme.accentColor,r=>{const o=Lt(r,.5),u=qe(r),d=this._currentTexture,c=a(o,u);s.setParameters({textureId:c.texture.id}),i.setParameters({color:E.toUnitRGBA(r)}),this._currentTexture=c,d==null||d.release()},me)}destroy(){var t;this._themeHandle.remove(),(t=this._currentTexture)==null||t.release(),super.destroy()}}function fr({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:a,calloutLength:s,discRadius:n}=ze,i=n*a,r=(c,g)=>{const h=[0,1,2,2,3,0];return new Nt(g,[[K.POSITION,new Ee([s-c,-c,0,s+c,-c,0,s+c,c,0,s-c,c,0],h,3,!0)],[K.UV0,new Ee([0,0,1,0,1,1,0,1],h,2,!0)]])},o=N(t,[[0,0,0],[s-n,0,0]]),u=N(t,[[0,0,0],[s-i,0,0]]),d=A;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[s,0,0]},focusMultiplier:a,radius:n,renderObjects:[new m(r(n,e),_.Unfocused|d),new m(o,_.Unfocused|d),new m(r(i,e),_.Focused|d),new m(u,_.Focused|d)],state:d}}var pe;(function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(pe||(pe={}));class Qr extends _e{constructor(t,a){const s=new W({width:1,renderOccluded:T.OccludeAndTransparent,isDecoration:!0}),n=new X({cullFace:Y.Back,renderOccluded:T.Opaque,isDecoration:!0}),i=new X({cullFace:Y.Back,renderOccluded:T.Opaque,isDecoration:!0}),r=new X({cullFace:Y.Back,renderOccluded:T.Opaque,isDecoration:!0}),o=new X({writeDepth:!1,cullFace:Y.Front,renderOccluded:T.Transparent,isDecoration:!0});super({view:t,...br({offsetMode:a,tubeMaterial:n,tipMaterial:i,capMaterial:r,outlineMaterial:o,calloutMaterial:s})}),this._themeHandle=be(()=>t.effectiveTheme.accentColor,u=>{const d=qe(u),c=E.toUnitRGBA(u),g=E.toUnitRGBA(d),h=E.toUnitRGBA(E.blendColors(d,u,.4)),f=E.toUnitRGBA(E.blendColors(d,u,.14));s.setParameters({color:c}),n.setParameters({color:f}),i.setParameters({color:g}),r.setParameters({color:h}),o.setParameters({color:c})},me)}destroy(){this._themeHandle.remove(),super.destroy()}}function br({offsetMode:e,tubeMaterial:t,tipMaterial:a,capMaterial:s,outlineMaterial:n,calloutMaterial:i}){const r=e===pe.CENTER_ON_CALLOUT?Q:0,o=[M(r,0,-Ne/2),M(r,0,Ne/2)],u=_r(o,!0),d=De({vertices:o,padding:0,materials:{tube:t,tip:a,cap:s}}),c=De({vertices:o,padding:Qt,materials:{tube:n,tip:n,cap:n}}),g=N(i,[[r,0,0],[r-Q,0,0]]),h=N(i,[[r,0,0],[r-Q,0,0]]);return{renderObjects:[...d.normal.map(f=>new m(f,_.Unfocused|A)),...c.normal.map(f=>new m(f,_.Unfocused|A)),new m(g,_.Unfocused|A|se),...d.focused.map(f=>new m(f,_.Focused|A)),...c.focused.map(f=>new m(f,_.Focused|A)),new m(h,_.Focused|A|se)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[u]},collisionPriority:1,radius:Xe,state:A}}function De({vertices:e,padding:t,materials:a}){const s=n=>{const i=e.slice(0),r=w(l.get(),i[0],i[1]);y(r,r);const o=w(l.get(),i[i.length-1],i[i.length-2]);if(y(o,o),t>0){const k=p(te(),o,-t);i[i.length-1]=b(k,k,i[i.length-1]);const U=p(te(),r,-t);i[0]=b(U,U,i[0])}const u=n?zt:1,d=ge*u,c=Xe*u,g=ve(F.get());if(t>0){const k=d/4,U=ee(l.get(),0,k,0),q=1+t/k;Me(g,g,U),We(g,g,ee(l.get(),q,q,q)),Me(g,g,p(U,U,-1/q))}const h=ve(ce()),f=M(0,1,0),O=Re(ce(),Pe(ye.get(),f,o));O[12]=i[i.length-1][0],O[13]=i[i.length-1][1],O[14]=i[i.length-1][2],G(O,O,g);const x=a.tube,S=mr(Zt*(n?qt:1)+t,i,x);S.transformation=h;const $=[S],ae=a.tip,H=Se(ae,d,c,24,!1,!1,!0);H.transformation=O,$.push(H);const B=a.cap,oe=Se(B,d,c,24,!1,!0,!1);oe.transformation=O,$.push(oe);const L=Re(ce(),Pe(ye.get(),f,r));return L[12]=i[0][0],L[13]=i[0][1],L[14]=i[0][2],G(L,L,g),$.push(H.instantiate({transformation:L})),$.push(oe.instantiate({transformation:L})),$};return{normal:s(!1),focused:s(!0)}}function mr(e,t,a){const s=[];for(let i=0;i<12;i++){const r=i/12*2*Math.PI;s.push([Math.cos(r)*e,Math.sin(r)*e])}return xt(a,s,t,[],[],!1)}function _r(e,t){const a=w(te(),e[e.length-1],e[e.length-2]);if(y(a,a),p(a,a,ge),b(a,a,e[e.length-1]),t){const s=w(te(),e[0],e[1]);return y(s,s),p(s,s,ge),b(s,s,e[0]),[s,...e,a]}return[...e,a]}const Tr=Object.freeze(Object.defineProperty({__proto__:null,build:Ye},Symbol.toStringTag,{value:"Module"}));export{Fr as A,he as B,re as C,hr as D,Gr as E,pe as H,Qr as I,yr as M,de as N,qr as P,Xr as U,A as V,v as _,Yr as a,Lr as b,Dr as c,Vr as d,Wr as e,jr as f,Zr as g,kr as h,jt as i,Br as j,Ur as k,Hr as l,vr as m,Ft as n,Nr as o,Pr as p,Rr as q,Er as r,xr as s,Cr as t,Mr as u,zr as v,Gt as w,Yt as x,se as y,$e as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}