import{d as F,l as _}from"./Responsive-QKXcW_1q.js";import{s as N,hv as q,hw as $,fv as R,gL as v,hx as G,hy as J,hz as K,cy as O,hA as Q,d8 as ee,hB as ie,hC as te,a2 as ne,hD as P,hE as oe}from"./index-J0iiHjMT.js";import{Y as ae,S as se}from"./chartUtilsAm5-QfmFJ3lc.js";import{o as le,u as Y,_ as re,b as de,r as ce,x as ue}from"./LineSeries-VcEznTH7.js";import{a2 as b,t as x,Y as pe,Z as xe}from"./Theme-QNc_77AM.js";import{u as W}from"./Tooltip-lrFZgXdG.js";import"./DefaultTheme-T7-VnRhA.js";import"./ColorSet-j9kKRPwP.js";import"./Tick-WQ_bPwW2.js";import"./Button-1STHXt3M.js";function fe(e,n,t=10){const i=X(n-e,!1);if(i===0)return[e,n];const o=X(i/(t-1),!0);return[Math.floor(e/o)*o,Math.ceil(n/o)*o]}function X(e,n){const t=Math.floor(Math.log10(e)),i=e/10**t;let o;return o=n?i<1.5?1:i<3?2:i<5?2.5:i<7?5:10:i<=1?1:i<=2?2:i<=3?2.5:i<=5?5:10,o*10**t}const A="#f8f8f8",E="#a9a9a9",g="#323232",me="line",ge="fill",h=15,m=12,z=.001,he=.1,Ae=.02,I={fontFamily:"Avenir Next",paddingBottom:m/2,paddingLeft:0,paddingRight:0,paddingTop:0,axisGridStroke:"#f4f4f4",axisLabelsFontSize:9,axisLabelsFontWeight:"400",axisLabelsColor:E,axisTooltipFontSize:12,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,axisTooltipPaddingTop:Math.round(m/4),axisTooltipPaddingBottom:Math.round(m/4),axisTooltipPaddingHorizontal:Math.round(h/4),xAxisMinGridDistance:50,xAxisLabelsSpacing:Math.round(m/2),xAxisMinLabelPosition:.05,xAxisMaxLabelPosition:.9,yAxisMinGridDistance:30,yAxisLabelSpacing:Math.round(h/4),yAxisMinLabelPosition:0,yAxisMaxLabelPosition:.8,seriesTooltipFontSize:12,seriesTooltipBackgroundColor:A,seriesTooltipLabelColor:g,seriesFillLighten:.9,seriesTooltipSpacing:m/2,seriesTooltipPaddingVertical:Math.round(h/4),seriesTooltipPaddingHorizontal:Math.round(h/4)},ve={...I,axisGridStroke:g,axisLabelsColor:E,axisTooltipBackgroundColor:g,axisTooltipLabelColor:A,seriesTooltipBackgroundColor:g,seriesTooltipLabelColor:A,seriesFillLighten:-.75},y={minX:void 0,maxX:void 0,minY:void 0,maxY:void 0};async function je(e){const n=await ae(e.container);N(e.abortOptions);const t=q(),i=t?ve:I;n.setThemes(t?[F.new(n),_.new(n)]:[F.new(n)]);const o=$(e.container),a=n.container.children.push(le.new(n,{panX:!0,panY:!0,paddingTop:i.paddingTop,paddingBottom:i.paddingBottom,paddingLeft:o?i.paddingRight:i.paddingLeft,paddingRight:o?i.paddingLeft:i.paddingRight,maxTooltipDistance:0}));a.zoomOutButton.set("forceHidden",!0);const s=a.xAxes.push(Y.new(n,{renderer:re.new(n,{})})),l=a.yAxes.push(Y.new(n,{renderer:de.new(n,{})})),c=P(null),r=P("loading"),d={params:e,chart:a,xAxis:s,yAxis:l,seriesInfos:new Map,messages:null,theme:i,pointerIsOver:!1,get state(){return r.value},get data(){return c.value},set data(u){c.value=u}};ye(d),Te(d),be(d);const p=R([Ce(d,e.onRangeChange),ke(d,e.onCursorPositionChange),L(n.events.once("frameended",()=>{r.value="ready"})),L(n)]);return{destroy:()=>{p.remove(),r.value="destroyed"},update:u=>{u.data===d.data&&u.messages===d.messages||M(d)||Le(d,u)},zoomOut:()=>V(d)}}function M(e){return e.state==="destroyed"}function be({chart:e,xAxis:n,yAxis:t}){const i=ce.new(e.root,{behavior:"none",xAxis:n,yAxis:t});i.lineY.set("visible",!1),e.set("cursor",i)}function ye(e){var s;const{chart:n,xAxis:t,theme:i}=e;t.setAll({extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(e,"distance"),strictMinMax:!0,strictMinMaxSelection:!0}),t.axisHeader.set("forceHidden",!0);const o=t.get("renderer");o.setAll({inside:!1,minGridDistance:i.xAxisMinGridDistance}),o.labels.template.setAll({centerX:b,centerY:b,fill:x(i.axisLabelsColor),fontFamily:i.fontFamily,fontSize:i.axisLabelsFontSize,fontWeight:i.axisLabelsFontWeight,maxPosition:i.xAxisMaxLabelPosition,minPosition:i.xAxisMinLabelPosition,paddingLeft:0,paddingRight:0,paddingTop:i.xAxisLabelsSpacing});const a=t.set("tooltip",W.new(n.root,{paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0}));(s=a.get("background"))==null||s.setAll({fill:x(i.axisTooltipBackgroundColor),stroke:void 0}),a.label.setAll({fill:x(i.axisTooltipLabelColor),fontFamily:i.fontFamily,fontSize:i.axisTooltipFontSize,paddingBottom:i.axisTooltipPaddingBottom,paddingLeft:i.axisTooltipPaddingHorizontal,paddingRight:i.axisTooltipPaddingHorizontal,paddingTop:i.axisTooltipPaddingTop}),o.grid.template.setAll({strokeOpacity:1,stroke:x(i.axisGridStroke)})}function Te(e){const{yAxis:n,theme:t}=e;n.setAll({baseValue:v().noDataValue,extraMax:0,extraMin:0,maxDeviation:0,numberFormatter:U(e,"elevation"),strictMinMax:!0,strictMinMaxSelection:!0,tooltip:void 0}),n.axisHeader.set("visible",!1);const i=$(e.params.container),o=n.get("renderer");o.setAll({minGridDistance:t.yAxisMinGridDistance,opposite:i,inside:!0}),o.labels.template.setAll({centerX:b,centerY:pe,fill:x(t.axisLabelsColor),fontFamily:t.fontFamily,fontSize:t.axisLabelsFontSize,fontWeight:t.axisLabelsFontWeight,maxPosition:t.yAxisMaxLabelPosition,minPosition:t.yAxisMinLabelPosition,paddingBottom:0,paddingLeft:i?0:t.yAxisLabelSpacing,paddingRight:i?t.yAxisLabelSpacing:0,paddingTop:0,textAlign:"start"}),o.grid.template.setAll({strokeOpacity:1,stroke:x(t.axisGridStroke)})}function Le(e,n){var l;if(M(e))return;const t=e.data??void 0,i=n.data??void 0;(l=e.chart.get("cursor"))==null||l.set("forceHidden",!(i!=null&&i.refined));const o=t!==i,a=(t==null?void 0:t.effectiveUnits)!==(i==null?void 0:i.effectiveUnits),s=(t==null?void 0:t.uniformScaling)!==(i==null?void 0:i.uniformScaling);e.data=i,e.messages=n.messages,(o||a)&&(Me(e),Pe(e)),s&&V(e),T(e)}function V(e){M(e)||(e.xAxis.zoom(0,1),e.yAxis.zoom(0,1))}function Me(e){const{chart:n,data:t,xAxis:i,yAxis:o}=e,{minX:a,maxX:s,minY:l,maxY:c}=Se({data:t,pixelWidth:i.width(),pixelHeight:o.height()}),r=!!(t!=null&&t.uniformScaling),d=!!(t!=null&&t.refined);n.setAll({panX:!0,panY:r,pinchZoomX:d,pinchZoomY:d&&r,wheelX:"panX",wheelY:d?r?"zoomXY":"zoomX":"none"}),i.setAll({max:s,min:a,panX:!0,panY:!1,zoomX:!0,zoomY:r}),o.setAll({max:c,min:l,panX:!1,panY:r,zoomX:r,zoomY:r})}function Se({data:e,pixelWidth:n,pixelHeight:t}){if(e==null)return y;const i=e.statistics,o=0,a=i==null?void 0:i.maxDistance;let s=i==null?void 0:i.minElevation,l=i==null?void 0:i.maxElevation;if(a==null||s==null||l==null)return y;const c=Math.max(a-o,z);let r=Math.max(l-s,z);const d=e.effectiveUnits;if(e.dynamicElevationRange){const p=G(c,d.distance,d.elevation);r=Math.max(r,p/v().maxChartRatio)}return s-=Ae*r,l=s+r+he*r,[s,l]=fe(s,l,10),r=l-s,e.uniformScaling?Fe({data:e,bounds:{minX:o,maxX:a,minY:s,maxY:l},pixelWidth:n,pixelHeight:t,centered:!0}):{minX:o,maxX:o+c,minY:s,maxY:s+r}}function Fe({data:e,bounds:n,pixelWidth:t,pixelHeight:i,centered:o}){if(e==null)return n;let{minX:a,maxX:s,minY:l,maxY:c}=n;if(a==null||s==null||l==null||c==null)return y;const r=s-a,d=c-l,p=e.effectiveUnits,u=G(d,p.elevation,p.distance)/i/(r/t);return u>=1?[a,s]=C([a,s],u,o):[l,c]=C([l,c],1/u,o),{minX:a,maxX:s,minY:l,maxY:c}}function C([e,n],t,i){const o=(n-e)*t;if(i){const a=(e+n)/2-o/2;return[a,a+o]}return[e,e+o]}function Pe(e){var r;const{chart:n,data:t,seriesInfos:i,xAxis:o,yAxis:a}=e;if(t==null||t.lines.length===0)return void n.series.clear();const s=new Map,l=new Set(n.series.values),c=t.lines.length;for(let d=0;d<c;d++){const p=t.lines[d];let u=i.get(p.id);u?(u.fill&&l.delete(u.fill),l.delete(u.line)):(u=Xe(e,p),u.fill&&n.series.push(u.fill),n.series.push(u.line)),s.set(u.id,u);const f=c-d-1;(r=u.fill)==null||r.set("layer",f),u.line.set("layer",c+f),Ye(e,u,p)}e.seriesInfos=s;for(const d of l)n.series.removeValue(d);o.set("layer",c+1),a.set("layer",c+2)}function Ye({theme:e},n,t){const i=x(t.color.toCss()),o=t.samples??[],a=o.length>0,{line:s,fill:l}=n;s.set("visible",a),s.set("stroke",i),l==null||l.set("visible",a),l==null||l.set("fill",xe.lighten(i,e.seriesFillLighten)),s.data.setAll(o),l==null||l.data.setAll(o)}function Xe(e,n){const{id:t}=n,i=k(e,`${me}-${t}`);i.setAll({dy:n.chartStrokeOffsetY,tooltip:ze(e)}),i.strokes.template.setAll({strokeWidth:n.chartStrokeWidth});let o=null;return n.chartFillEnabled&&(o=k(e,`${ge}-${t}`),o.fills.template.setAll({fillOpacity:1,visible:!0})),{id:t,line:i,fill:o}}function k(e,n){return ue.new(e.chart.root,{connect:!1,excludeFromTotal:!0,fill:void 0,id:n,stroke:void 0,valueXField:"distance",valueYField:"elevation",xAxis:e.xAxis,yAxis:e.yAxis})}function ze({theme:e,chart:n}){var a;const t=W.new(n.root,{forceHidden:!0,getFillFromSprite:!1,getLabelFillFromSprite:!1,pointerOrientation:"vertical",visible:!1}),i=e.seriesTooltipPaddingHorizontal,o=e.seriesTooltipPaddingVertical;return t.label.setAll({fill:x(e.seriesTooltipLabelColor),fontFamily:e.fontFamily,fontSize:e.seriesTooltipFontSize,paddingBottom:o,paddingLeft:i,paddingRight:i,paddingTop:o,textAlign:"start"}),(a=t.get("background"))==null||a.setAll({stroke:void 0,fill:x(e.seriesTooltipBackgroundColor)}),t.adapters.add("dy",s=>{var r;const l=e.seriesTooltipSpacing,c=((r=t.get("pointTo"))==null?void 0:r.y)??0;return(s??0)+(t.y()>c?l:-l)}),t}function Ce(e,n){const{xAxis:t,yAxis:i}=e,o=()=>{n(w(t),w(i))},a=s=>[s.on("start",o),s.on("end",o)];return j([...a(t),...a(i)])}function w(e){const n=Math.abs((e.get("end")??0)-(e.get("start")??0)),t=n!==0?1/n:1;return Math.abs(1-t)<oe()?1:t}function ke(e,n){const{chart:t,xAxis:i,yAxis:o}=e,a=t.get("cursor"),s=t.plotContainer.events,l=r=>{e.pointerIsOver=r,T(e)},c=()=>{l(!1),n(null,null)};return j([a==null?void 0:a.events.on("cursormoved",()=>{if(!e.pointerIsOver)return;T(e);let r=(a==null?void 0:a.getPrivate("positionX"))??0,d=(a==null?void 0:a.getPrivate("positionY"))??0;const p=e.data;if((p==null?void 0:p.statistics)!=null){const{maxDistance:u,minElevation:f,maxElevation:S}=p.statistics;u!=null&&(r=B(r,H(i),D(i),0,u)),f!=null&&S!=null&&(d=B(d,H(o),D(o),f,S))}n(r,d)}),s.on("pointerover",()=>l(!0)),s.on("pointerout",c),s.on("blur",c)])}function B(e,n,t,i,o){return(n+e*(t-n)-i)/(o-i)}function T(e){const n=we(e);if(!n)return void e.seriesInfos.forEach(t=>{var i;(i=t.line.get("tooltip"))==null||i.set("forceHidden",!0)});e.seriesInfos.forEach(t=>{const i=t.line.get("tooltip");i.set("forceHidden",!1),i.label.set("text",n)}),e.xAxis.getTooltip().setAll({tooltipText:De(e)})}function we(e){const{data:n}=e,t=n==null?void 0:n.lines.map(i=>{var o;return{line:i,y:(o=Z(e,i))==null?void 0:o.elevation}}).sort(Be);return t&&t.length!==0&&t[0].y!=null?t.map(({y:i,line:o})=>He(e,o,i)).join(`
`):null}function Be({y:e},{y:n}){return e==null?1:n==null?-1:n-e}function He(e,n,t){const{data:i,messages:o}=e;if(i==null||o==null)return"";const a=v().formatPrecision,s=J(o.chartTooltip,{name:K(n,o),elevation:t!=null?O(o,t,i.effectiveUnits.elevation,a):Q});return`[${n.color.toHex()}]●[/] ${s}`}function De(e){const{data:n,messages:t}=e;if(n==null||t==null)return"";const i=n.lines[0],o=i?Z(e,i):null,a=v().formatPrecision;return o!=null?O(t,o.distance,n.effectiveUnits.distance,a):"-"}function U(e,n){const t=se.new(e.chart.root,{});return t.format=(i,o,a)=>{const{data:s,messages:l}=e;return l==null||s==null||typeof i=="string"?"":`${ee(i,{maximumFractionDigits:a})} ${ie(l,s.effectiveUnits[n],"abbr")}`},t}function Z({chart:e,xAxis:n},t){const i=t.samples??[];if(i.length===0)return null;const o=e.get("cursor"),a=(o==null?void 0:o.getPrivate("positionX"))??0,s=n.toAxisPosition(a),l=n.positionToValue(s);return te(i,l,c=>c.distance)}function H(e){return e.positionToValue(e.get("start")??0)}function D(e){return e.positionToValue(e.get("end")??1)}function j(e){return R(e.map(L))}function L(e){return ne(()=>{e==null||e.dispose()})}export{je as createChart,Se as getAdjustedBounds};
