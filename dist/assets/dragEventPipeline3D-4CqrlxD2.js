import{aI as M,aJ as m,aK as $,aL as x,aM as R,aN as g,aa as i,aO as N,aP as b,aQ as y,aE as H,aR as E,aS as I,aT as w,aG as U,aU as S,aV as D,aW as G,ax as P,au as v,at as A,aX as h,aY as k,aZ as O,a_ as F}from"./index-J0iiHjMT.js";import{U as q}from"./InteractiveToolBase-WDic4GPF.js";function B(n,e){return C(n,()=>e)}function Z(n){return C(n,e=>e.plane)}function C(n,e){const t=i(),a=i();let l=!1;return r=>{const o=e(r);if(r.action==="start"){const c=m(r.screenStart,$(x.get())),u=R(n.state.camera,c,T);u!=null&&(l=g(o,u,t))}if(!l)return null;const s=m(r.screenEnd,$(x.get())),d=R(n.state.camera,s,T);return d==null?null:g(o,d,a)?{...r,renderStart:t,renderEnd:a,plane:o,ray:d}:null}}function _(n,e,t=0,a=null,l=null){let r=null;return o=>{if(o.action==="start"&&(r=n.sceneIntersectionHelper.intersectElevationFromScreen(E(o.screenStart.x,o.screenStart.y),e,t,l),r!=null&&a!=null&&!I(r,r,a))||r==null)return null;const s=n.sceneIntersectionHelper.intersectElevationFromScreen(E(o.screenEnd.x,o.screenEnd.y),e,t,l);return s!=null&&(a==null||I(s,s,a))?{...o,mapStart:r,mapEnd:s}:null}}function z(n,e,t,a=null,l=null){return _(n,t,N(e,n,t),a,l)}function J(n,e,t,a=null,l=null){return z(n,t,b(e),a,l)}function j(n,e,t,a){const l=e.toMap(n.screenStart,{include:[t]});return l!=null?J(e,t,l,a):null}function K(n,e){const t=V,a=W,l=w();n.renderCoordsHelper.worldUpAtPosition(e,t);const r=U(l,t,S(a,e,n.state.camera.eye));return U(r,r,t),D(e,r,l)}function nn(n,e,t){let a=null;const l=new q;return l.next(B(n,K(n,e))).next(L(n,e)).next(Q(n,t)).next(r=>{r.mapEnd.x=r.mapStart.x,r.mapEnd.y=r.mapStart.y,a=r}),r=>(a=null,l.execute(r),a)}function L(n,e){const t=i(),a=y(e);n.renderCoordsHelper.worldUpAtPosition(e,t);const l=i(),r=i(),o=s=>(S(s,s,e),G(t,s,s),n.viewingMode==="global"&&y(s)*Math.sign(P(t,s))<.001-a&&S(s,v(s,t,.001),e),A(s,s,e),s);return s=>(s.renderStart=o(H(l,s.renderStart)),s.renderEnd=o(H(r,s.renderEnd)),s)}function Q(n,e){const t=n.renderCoordsHelper;return a=>{const l=t.fromRenderCoords(a.renderStart,e),r=t.fromRenderCoords(a.renderEnd,e);return l!=null&&r!=null?{...a,mapStart:l,mapEnd:r}:null}}var f;function en(n){let e=null;return t=>{switch(t.action){case"start":e=n.disableDisplay();break;case"end":case"cancel":e!=null&&(e.remove(),e=null)}return t}}function tn(n,e=null){const t=h(n.state.viewingMode);t.options.selectionMode=!0,t.options.store=k.MIN,t.options.hud=!1;const a=E(),l={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},r=i(),o=e??n.spatialReference,s=c=>{n.map.ground&&n.map.ground.opacity<1?l.exclude.add(O):l.exclude.delete(O),n.sceneIntersectionHelper.intersectIntersectorScreen(m(c,a),t,l);const u=t.results.min;let p;if(u.getIntersectionPoint(r))p=u.intersector===F.TERRAIN?f.GROUND:f.OTHER;else{if(!t.results.ground.getIntersectionPoint(r))return null;p=f.GROUND}return{location:n.renderCoordsHelper.fromRenderCoords(r,o),surfaceType:p}};let d;return c=>{if(c.action==="start"){const p=s(c.screenStart);d=p!=null?p.location:null}if(d==null)return null;const u=s(c.screenEnd);return(u==null?void 0:u.location)!=null?{...c,mapStart:d,mapEnd:u.location,surfaceType:u.surfaceType}:null}}(function(n){n[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER"})(f||(f={}));const V=i(),W=i(),T=M();export{en as A,J as D,tn as F,f as G,B as H,j as M,nn as P,z as T,Z as U,Q as k};
